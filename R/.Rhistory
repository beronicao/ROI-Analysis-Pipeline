View(dF.F.means)
colnames(dF.F.means) <- c("mean(dF/F)")
mean.dF.F <- as.data.frame(apply(results_B, 1, mean))
colnames(mean.dF.F) <- c("mean(dF/F)")
stdev.dF.F <- as.data.frame(apply(results_B, 1, sd))
View(stdev.dF.F)
colnames(stdev.dF.F) <- c("stdev(dF/F)")
View(listofROIs2.df)
stats.dF.F <- cbind(results_B, mean.dF.F, stdev.dF.F)
View(stats.dF.F)
stats.dF.F.m <- cbind(dF.Fb.values1, mean.dF.F, stdev.dF.F)
View(stats.dF.F.m)
stats.dF.F <- cbind(results_B$frame, mean.dF.F, stdev.dF.F)
colnames(stats.dF.F) <- c("frame", "mean", "stdev")
View(dF.Fb.values1)
rplot <- ggplot(data=stats.dF.F, aes(x=frame, y=mean)) +
geom_point(size=0.01)
rplot + labs(y = "dF/F (%)") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin=y-stdev, ymax=y+stdev) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot + labs(y = "dF/F (%)") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin=mean-stdev, ymax=mean+stdev) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot + labs(y = "dF/F (%)") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin='mean'-'stdev', ymax=mean+stdev) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot + labs(y = "dF/F (%)") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean-stats.dF.F$stdev, ymax=stats.dF.F$mean+stats.dF.F$stdev) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot <- ggplot(data=stats.dF.F, aes(x=frame, y=mean))
ggplot(data=stats.dF.F, aes(x=frame, y=mean))
ggplot(data=stats.dF.F, aes(x=frame, y=mean, colour=frame))
ggplot(data=stats.dF.F, aes(x=frame, y=mean)) +
geom_point(size=0.01)
ggplot(data=stats.dF.F, aes(x=stats.dF.F$frame, y=stats.dF.F$mean)) +
geom_point(size=0.01)
ggplot(data=stats.dF.F, aes(x='frame', y='mean')) +
geom_point(size=0.01)
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean']])) +
geom_point(size=0.01)
colnames(stats.dF.F) <- c("frame", "mean.dF.F", "stdev.dF.F")
View(stats.dF.F)
ggplot(data=stats.dF.F, aes(x=frame, y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 <- ggplot(data=stats.dF.F, aes(x=frame, y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F (%)") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
View(frames)
ggplot(data=stats.dF.F, aes(x=frames, y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
#geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
View(dF.Fb.values1)
results.mat <- as.matrix(results_B)
mean.dF.F1 <- as.data.frame(apply(results.mat, 1, mean))
View(mean.dF.F1)
View(mean.dF.F)
View(results.mat)
mean.dF.F1 <- as.data.frame(apply(results.mat[,2:length(results.mat)], 1, mean))
mean.dF.F1 <- as.data.frame(apply(results_B[,2:length(results_B)], 1, mean))
View(mean.dF.F1)
mean.dF.F <- as.data.frame(apply(results_B[,2:length(results_B)], 1, mean))
colnames(mean.dF.F) <- c("mean")
stdev.dF.F <- as.data.frame(apply(results_B[,2:length(results_B)], 1, sd))
colnames(stdev.dF.F) <- c("stdev")
stats.dF.F <- cbind(results_B$frame, mean.dF.F, stdev.dF.F)
View(stats.dF.F)
colnames(stats.dF.F) <- c("frame", "mean.dF.F", "stdev.dF.F")
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
colors()
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, colour=frame) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=frames)) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour='frame')) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], fill=stdev.dF.F)) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], fill=stdev.dF.F)) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(fill=stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(fill=stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(fill=stats.dF.F$stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(colour=stats.dF.F$stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01, aes(colour=party))
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(colour=stats.dF.F$stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01, aes(colour=black))
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(colour=stats.dF.F$stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01, aes(colour='black'))
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(colour=stats.dF.F$stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01, aes(colour='party'))
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(colour=stats.dF.F$stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour='black')) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(colour=stats.dF.F$stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(colour=stats.dF.F$stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, aes(fill=stats.dF.F$stdev.dF.F)) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, fill=stats.dF.F$stdev.dF.F) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, inherit.aes=FALSE, fill=stats.dF.F$stdev.dF.F) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
rplot2 + labs(y = "dF/F") +
labs(x = "frame") +
labs(title = expression(paste("GCaMP6f: Ca"^"2+"*" Activity")), subtitle = "Run 2: TTX + TGOT") +
theme(plot.title = element_text(hjust = 0.5)) +
geom_errorbar(x=stats.dF.F[['frame']], ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F, inherit.aes=FALSE) +
#scale_fill_continuous(guide = guide_legend(keywidth = 7, keyheight = 12)) +
scale_x_continuous(expand = c(0.006,0))
rplot2 <- ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01)
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F)
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01) +
geom_errorbar(stats.dF.F, mean, ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F)
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01) +
geom_errorbar(mean.dF.F, ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F)
View(results_B)
View(df.m1)
ROImeans.dt <- cell.dt[,2:length(cell.dt), drop=FALSE]   # Keeps only "Mean_" columns (ROI mean values)
bROI.values = cell.dt[,2, drop=FALSE]   # Keeps only "Mean1" column (baseline ROI values)
#colnames(bROI.values) <- c("bROI")
frames = cell.dt[,1, drop=FALSE]   # Keeps only "frames" column
ROI.dt <- cbind(frames, ROImeans.dt)
bROI.dt <- cbind(frames, bROI.values)
library(reshape2)
df.m <- melt(ROI.dt, id.vars='frame')   #restructuring the data
colnames(df.m) <- c("frame", "ROI", "Ft")  #renaming columns
head(df.m)
df.m1 <- cbind(df.m, bROI.values)
Fbnorm.func <- function(Ft, Fb){
result1 <- (Ft - Fb)/Fb
return(result)
}
Fbnorm.func <- function(Ft, Fb){
result <- (Ft - Fb)/Fb
return(result)
}
subtract.FbROI.func <- function(Ft.adj, Mean1){
result1 <- (Ft.adj - Mean1)
return(result1)
}
subtract.FbROI.func <- function(dF.Fb, Mean1){
result1 <- (dF.Fb - Mean1)
return(result1)
}
means.mat <- as.matrix(ROImeans.dt)
listofROIs <- as.list(colnames(means.mat))
listofROIs1 <- as.character(listofROIs)
listofROIs2.df <- as.data.frame(listofROIs1)
colnames(listofROIs2.df) <- c("ROI")
Fb.values.mat <- as.matrix(Fb.values)
Fb.df <- as.data.frame(apply(Fb.values.mat, 2, mean)) #creates a dataframe of mean Fb values for each ROI
colnames(Fb.df) <- c("Fb")   #renaming column
Fb.df1 <- cbind(listofROIs2.df, Fb.df)
df.m2 <- merge(df.m1, Fb.df1, by="ROI")   # Adds 'Fb' column to the data
View(df.m2)
df.m2$result1 <- Fbnorm.func(df.m2$Ft, df.m2$Fb)   # running Fb-normalization function (results are added as a new column of data labeled "result1")
colnames(df.m2)[colnames(df.m2)=="result1"] <- "dF.Fb"   #renaming column
View(cell.dt)
View(Fb.df1)
Fb.range <- cell.dt[(b.range[[1]]:b.range[[2]]), , drop=FALSE]
Fb.values <- Fb.range[ ,2:length(Fb.range), drop=FALSE]
Fb.values.mat <- as.matrix(Fb.values)
Fb.df <- as.data.frame(apply(Fb.values.mat, 2, mean)) #creates a dataframe of mean Fb values for each ROI
colnames(Fb.df) <- c("Fb")   #renaming column
Fb.df1 <- cbind(listofROIs2.df, Fb.df)
df.m2 <- merge(df.m1, Fb.df1, by="ROI")   # Adds 'Fb' column to the data
df.m2$result1 <- Fbnorm.func(df.m2$Ft, df.m2$Fb)   # running Fb-normalization function (results are added as a new column of data labeled "result1")
colnames(df.m2)[colnames(df.m2)=="result1"] <- "dF.Fb"   #renaming column
View(bROI.values)
df.m <- melt(ROI.dt, id.vars='frame')   #restructuring the data
colnames(df.m) <- c("frame", "ROI", "Ft")  #renaming columns
head(df.m)
df.m <- melt(cell.dt, id.vars='frame')
View(df.m)
colnames(df.m) <- c("frame", "ROI", "Ft")  #renaming columns
ROImeans.dt <- cell.dt[,2:length(cell.dt), drop=FALSE]   # Keeps only "Mean_" columns (ROI mean values)
View(ROImeans.dt)
means.mat <- as.matrix(ROImeans.dt)
listofROIs <- as.list(colnames(means.mat))
listofROIs1 <- as.character(listofROIs)
listofROIs2.df <- as.data.frame(listofROIs1)
colnames(listofROIs2.df) <- c("ROI")
b.range <- exp.values[1,1:2]
Fb.range <- cell.dt[(b.range[[1]]:b.range[[2]]), , drop=FALSE]
Fb.values <- Fb.range[ ,2:length(Fb.range), drop=FALSE]
Fb.values.mat <- as.matrix(Fb.values)
Fb.df <- as.data.frame(apply(Fb.values.mat, 2, mean)) #creates a dataframe of mean Fb values for each ROI
colnames(Fb.df) <- c("Fb")   #renaming column
Fb.df1 <- cbind(listofROIs2.df, Fb.df)
df.m1 <- merge(df.m, Fb.df1, by="ROI")   # Adds 'Fb' column to the data
df.m1$result1 <- Fbnorm.func(df.m1$Ft, df.m1$Fb)   # running Fb-normalization function (results are added as a new column of data labeled "result1")
colnames(df.m1)[colnames(df.m1)=="result1"] <- "dF.Fb"   #renaming column
View(df.m1)
temp1a <- df.m1[ ,1:2, drop = FALSE]
temp1b <- df.m1[ ,5, drop = FALSE]
df.m2 <- cbind(temp1a, temp1b)
df.unmelted <- dcast(data = df.m2, formula = frame~ROI, fun.aggregate = sum, value.var = "dF.Fb")
View(ROI.dt)
bROI.values = cell.dt[,2, drop=FALSE]   # Keeps only "Mean1" column (baseline ROI values)
df.m3 <- cbind(df.2, bROI.values)
View(df.m2)
df.m3 <- cbind(df.m2, bROI.values)
View(df.m3)
df.unmelted <- dcast(data = df.m2, formula = frame~ROI, fun.aggregate = sum, value.var = "dF.Fb")
View(df.unmelted)
adj.bROI.values = df.unmelted[,2, drop=FALSE]   # Keeps only "Mean1" column (baseline ROI values)
View(adj.bROI.values)
df.m3 <- cbind(df.m2, adj.bROI.values)
subtract.FbROI.func <- function(dF.Fb, Mean1){
result1 <- (dF.Fb - Mean1)
return(result1)
}
View(subtract.FbROI.func)
View(subtract.FbROI.func)
View(subtract.FbROI.func)
View(Fbnorm.func)
df.m3$result1 <- subtract.FbROI.func(df.m3$dF.Fb, df.m3$Mean1)   #running function (results are added as a new column of data labeled "result")
colnames(df.m3)[colnames(df.m3)=="result1"] <- "dF.Fb.adj"   #renaming column of adjusted Ft values
head(df.m3)
temp2a <- df.m3[ ,1:2, drop = FALSE]
temp2b <- df.m3[ ,5, drop = FALSE]
dF.Fb.values <- cbind(temp2a, temp2b)
View(dF.Fb.values)
View(dF.Fb.values1)
results_B <- dcast(data = dF.Fb.values, formula = frame~ROI, fun.aggregate = sum, value.var = "dF.Fb")
results_B <- dcast(data = dF.Fb.values, formula = frame~ROI, fun.aggregate = sum, value.var = "dF.Fb.adj")
View(results_B)
mean.dF.F <- as.data.frame(apply(results_B[,2:length(results_B)], 1, mean))
stdev.dF.F <- as.data.frame(apply(results_B[,2:length(results_B)], 1, sd))
stats.dF.F <- cbind(results_B$frame, mean.dF.F, stdev.dF.F)
colnames(stats.dF.F) <- c("frame", "mean.dF.F", "stdev.dF.F")
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01) +
geom_errorbar(mean.dF.F, ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F)
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F)
View(stats.dF.F)
mean.dF.F <- as.data.frame(apply(results_B[,3:length(results_B)], 1, mean))
stdev.dF.F <- as.data.frame(apply(results_B[,3:length(results_B)], 1, sd))
stats.dF.F <- cbind(results_B$frame, mean.dF.F, stdev.dF.F)
ggplot(data=dF.Fb.values1, aes(x=frame, y=(dF.Fb.values1[['dF.Fb']])*100, colour=ROI)) +
geom_point(size=0.02)
ggplot(data=dF.Fb.values, aes(x=frame, y=(dF.Fb.values1[['dF.Fb']])*100, colour=ROI)) +
geom_point(size=0.02)
ggplot(data=dF.Fb.values, aes(x=frame, y=(dF.Fb.values[['dF.Fb']])*100, colour=ROI)) +
geom_point(size=0.02)
ggplot(data=dF.Fb.values, aes(x=frame, y=(dF.Fb.values[['dF.Fb.adj']])*100, colour=ROI)) +
geom_point(size=0.02)
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F)
colnames(stats.dF.F) <- c("frame", "mean.dF.F", "stdev.dF.F")
ggplot(data=stats.dF.F, aes(x=stats.dF.F[['frame']], y=stats.dF.F[['mean.dF.F']], colour=stats.dF.F[['mean.dF.F']])) +
geom_point(size=0.01) +
geom_errorbar(ymin= stats.dF.F$mean.dF.F-stats.dF.F$stdev.dF.F, ymax=stats.dF.F$mean.dF.F+stats.dF.F$stdev.dF.F)
library(readr)
library(data.table)
cell.dt <- read_csv("Results.csv")
colnames(cell.dt)[colnames(cell.dt)=="X1"] <- "frame"   #renaming column
ROImeans.dt <- cell.dt[,2:length(cell.dt), drop=FALSE]   # Keeps only "Mean_" columns (ROI mean values)
frames = cell.dt[,1, drop=FALSE]   # Keeps only "frames" column
#############################
#install.packages("reshape2")
library(reshape2)
df.m <- melt(cell.dt, id.vars='frame')   #restructuring the data
colnames(df.m) <- c("frame", "ROI", "Ft")  #renaming columns
head(df.m)
#############################
#### Creating functions #####
# dF/Fb = (Ft-Fb)/Fb #
# Fb = mean(Ft_b1:b2) #
# b1 = Ft at frame 2500
# b2 = Ft at frame 3400
Fbnorm.func <- function(Ft, Fb){
result <- (Ft - Fb)/Fb
return(result)
}
###
subtract.FbROI.func <- function(dF.Fb, Mean1){
result1 <- (dF.Fb - Mean1)
return(result1)
}
#############################
means.mat <- as.matrix(ROImeans.dt)
listofROIs <- as.list(colnames(means.mat))
listofROIs1 <- as.character(listofROIs)
listofROIs2.df <- as.data.frame(listofROIs1)
colnames(listofROIs2.df) <- c("ROI")
#############################
#experiment <- read_lines("~/Documents/GitHub/ROI-Analysis-Pipeline/data/2017-05-23 demo cell1/experiment.txt", skip=1)
experiment <- read_lines("experiment.txt", skip=1)
exp <- gsub("=", ",", experiment)
exp1 <- gsub("-", ",", exp)
exp.values <- read.table(textConnection(exp1), sep = ",", row.names = 1, col.names = c("condition","b1","b2"))
b.range <- exp.values[1,1:2]
Fb.range <- cell.dt[(b.range[[1]]:b.range[[2]]), , drop=FALSE]
Fb.values <- Fb.range[ ,2:length(Fb.range), drop=FALSE]
Fb.values.mat <- as.matrix(Fb.values)
Fb.df <- as.data.frame(apply(Fb.values.mat, 2, mean)) #creates a dataframe of mean Fb values for each ROI
colnames(Fb.df) <- c("Fb")   #renaming column
Fb.df1 <- cbind(listofROIs2.df, Fb.df)
df.m1 <- merge(df.m, Fb.df1, by="ROI")   # Adds 'Fb' column to the data
df.m1$result1 <- Fbnorm.func(df.m1$Ft, df.m1$Fb)   # running Fb-normalization function (results are added as a new column of data labeled "result1")
colnames(df.m1)[colnames(df.m1)=="result1"] <- "dF.Fb"   #renaming column
#############################
temp1a <- df.m1[ ,1:2, drop = FALSE]
temp1b <- df.m1[ ,5, drop = FALSE]
df.m2 <- cbind(temp1a, temp1b)
df.unmelted <- dcast(data = df.m2, formula = frame~ROI, fun.aggregate = sum, value.var = "dF.Fb")
adj.bROI.values = df.unmelted[,2, drop=FALSE]   # Keeps only "Mean1" column (baseline ROI values)
df.m3 <- cbind(df.m2, adj.bROI.values)
df.m3$result1 <- subtract.FbROI.func(df.m3$dF.Fb, df.m3$Mean1)   #running function (results are added as a new column of data labeled "result")
colnames(df.m3)[colnames(df.m3)=="result1"] <- "dF.Fb.adj"   #renaming column of adjusted Ft values
head(df.m3)
#############################
temp2a <- df.m3[ ,1:2, drop = FALSE]
temp2b <- df.m3[ ,5, drop = FALSE]
dF.Fb.values <- cbind(temp2a, temp2b)
results <- dcast(data = dF.Fb.values, formula = frame~ROI, fun.aggregate = sum, value.var = "dF.Fb.adj")
results_B <- as.data.frame(apply(results, 2, function(x) x*100))
filename <- "~/Documents/GitHub/ROI-Analysis-Pipeline/data/2017-05-23 demo cell1/Results.csv"
cell.dt <- read_csv(filename)
filename
cell = read_csv(filepath+filename)
filepath = "~/Documents/GitHub/ROI-Analysis-Pipeline/data/2017-05-23 demo cell1/"
filename ="Results.csv"
cell = read_csv(filepath+filename)
cell = read_csv(filepath%+%filename)
cell = read_csv(filepath%s%filename)
cell = read_csv(filepath,filename)
cell = read_csv(filepath filename)
cell.dt <- read_csv(filepath+"Results.csv")
cell.dt <- read_csv(filepath,"Results.csv")
cell.dt <- read_csv(filepath("Results.csv"))
file1 = print(args[1])
